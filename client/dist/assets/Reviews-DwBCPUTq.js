import{o as e}from"./rolldown-runtime-BgAqdD8a.js";import{a as s,r as t,t as a}from"./motion-Q_hw2Ya2.js";import{I as r,st as i,u as l,ut as n,vt as o,x as d}from"./vendor-D_eNeWdO.js";import{a as c,o as m}from"./i18n-PYB7o98L.js";import{c as x,s as u}from"./index-CSH1YS6q.js";var v=e(s(),1),g=t();m();var h=()=>{const{user:e}=u(),{t:s,i18n:t}=i(),m=(0,v.useMemo)((()=>({headers:{Authorization:`Bearer ${null==e?void 0:e.token}`}})),[e]),[h,p]=(0,v.useState)([]),[b,f]=(0,v.useState)({}),[y,j]=(0,v.useState)(!1),w=e=>{const s=t.language||"en",a=(e.translations||{})[s];return{name:(null==a?void 0:a.name)||e.name,description:(null==a?void 0:a.description)||e.description}};(0,v.useEffect)((()=>{var e;(e=o((function*(){j(!0);try{const{data:e}=yield x.get("/products");p(e||[])}catch(e){l.error(s("reviews.error_loading"))}finally{j(!1)}})),function(){return e.apply(this,arguments)})()}),[s]);const N=(_=o((function*(e){var t,a;const r={rating:Number((null===(t=b[e])||void 0===t?void 0:t.rating)||0),comment:String((null===(a=b[e])||void 0===a?void 0:a.comment)||"")};if(r.rating&&r.comment.trim())try{const{data:t}=yield x.post(`/products/${e}/reviews`,r,m);l.success(s("reviews.added_success")),p((s=>s.map((s=>s._id===e?c(c({},s),{},{reviews:[...s.reviews||[],t],numReviews:(s.numReviews||0)+1}):s)))),f((s=>c(c({},s),{},{[e]:{rating:0,comment:""}})))}catch(n){var i;l.error((null===(i=n.response)||void 0===i||null===(i=i.data)||void 0===i?void 0:i.message)||s("reviews.add_failed"))}else l.error(s("reviews.validation_required"))})),function(e){return _.apply(this,arguments)});var _;return e?(0,g.jsxs)("main",{className:"min-h-screen bg-gradient-to-b from-rose-50/70 via-white to-rose-100/70",children:[(0,g.jsxs)("div",{className:"relative pt-32 pb-16 lg:pt-40 lg:pb-24",children:[(0,g.jsx)("div",{className:"absolute inset-0 z-0 opacity-30",children:(0,g.jsx)("div",{className:"absolute inset-0 bg-repeat bg-center",style:{backgroundImage:"url(/images/patterns/subtle-dots.svg)"}})}),(0,g.jsx)("div",{className:"container mx-auto px-4 relative z-10",children:(0,g.jsxs)(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-3xl mx-auto text-center",children:[(0,g.jsx)("p",{className:"text-xs md:text-sm font-semibold tracking-[0.25em] uppercase text-primary/80 mb-3",children:s("reviews.page_title")}),(0,g.jsx)("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-serif text-gray-900 mb-4",children:s("reviews.page_title")}),(0,g.jsx)("p",{className:"text-gray-600 max-w-2xl mx-auto text-base md:text-lg",children:s("reviews.page_subtitle")})]})})]}),(0,g.jsx)("div",{className:"container mx-auto px-4 pb-16",children:y?(0,g.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,g.jsx)("div",{className:"w-10 h-10 border-4 border-primary border-t-transparent rounded-full animate-spin"})}):(0,g.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:h.map((e=>{var t,r,i,l,n,o;return(0,g.jsx)(a.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},children:(0,g.jsxs)("div",{className:"card-strong bg-white/90 rounded-3xl overflow-hidden transition-all duration-300 hover:shadow-2xl hover:-translate-y-2 border border-rose-100/80 hover:border-rose-200/90 h-full flex flex-col",children:[(0,g.jsx)("div",{className:"p-6",children:(0,g.jsxs)("div",{className:"flex items-start gap-5",children:[(0,g.jsx)("div",{className:"w-20 h-20 rounded-2xl overflow-hidden bg-gray-100 flex-shrink-0",children:(0,g.jsx)("img",{src:(null===(t=e.image)||void 0===t?void 0:t.startsWith("http"))||(null===(r=e.image)||void 0===r?void 0:r.startsWith("/"))?e.image:`/images/${e.image}`,alt:w(e).name,className:"w-full h-full object-cover",loading:"lazy"})}),(0,g.jsxs)("div",{className:"flex-grow",children:[(0,g.jsx)("h3",{className:"font-semibold text-gray-900 text-lg mb-1",children:w(e).name}),(0,g.jsx)("p",{className:"text-xs md:text-sm text-gray-500 mb-2",children:(o=e.category,{Beauty:s("category.beauty"),Skincare:s("category.skincare"),Bodycare:s("category.bodycare"),Haircare:s("category.haircare"),Fragrance:s("category.fragrance"),Tools:s("category.tools"),Collection:s("category.collection")}[o]||o)}),(0,g.jsxs)("div",{className:"mt-1 flex items-center gap-2 text-amber-500 text-xs md:text-sm",children:[(0,g.jsxs)("div",{className:"flex items-center gap-1",children:[(0,g.jsx)(d,{className:"w-4 h-4"}),(0,g.jsx)("span",{className:"font-semibold",children:(null===(i=e.rating)||void 0===i||null===(l=i.toFixed)||void 0===l?void 0:l.call(i,1))||0})]}),(0,g.jsx)("span",{className:"text-gray-400",children:"â€¢"}),(0,g.jsx)("span",{className:"text-gray-600",children:s("product.reviews_label",{count:e.numReviews||0})})]})]})]})}),(0,g.jsxs)("div",{className:"bg-gray-50/80 p-6 space-y-4 mt-auto",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"text-sm font-semibold text-gray-700 mb-2 block",children:s("reviews.rating_label")}),(0,g.jsx)("div",{className:"flex items-center gap-2",children:[1,2,3,4,5].map((s=>{var t;return(0,g.jsx)("button",{onClick:()=>f((t=>c(c({},t),{},{[e._id]:c(c({},t[e._id]||{}),{},{rating:s})}))),className:"transition-colors hover:text-amber-400 "+(((null===(t=b[e._id])||void 0===t?void 0:t.rating)||0)>=s?"text-amber-400":"text-gray-300"),children:(0,g.jsx)(d,{className:"w-6 h-6"})},s)}))})]}),(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{className:"text-sm font-semibold text-gray-700 mb-2 block",children:s("reviews.comment_label")}),(0,g.jsx)("textarea",{rows:4,value:(null===(n=b[e._id])||void 0===n?void 0:n.comment)||"",onChange:s=>f((t=>c(c({},t),{},{[e._id]:c(c({},t[e._id]||{}),{},{comment:s.target.value})}))),className:"input w-full text-sm md:text-base",placeholder:s("reviews.comment_placeholder",{name:w(e).name})})]}),(0,g.jsx)("button",{onClick:()=>N(e._id),className:"w-full btn btn-primary rounded-full py-3 font-semibold text-base",children:s("reviews.submit")})]})]})},e._id)}))})})]}):(0,g.jsx)("main",{className:"min-h-screen bg-gradient-to-b from-rose-50/70 via-white to-rose-100/70 flex items-center justify-center px-4",children:(0,g.jsxs)("div",{className:"card-strong max-w-md w-full text-center p-10 bg-white/90",children:[(0,g.jsx)("div",{className:"bg-rose-50 rounded-full w-24 h-24 flex items-center justify-center mx-auto mb-6 shadow-md",children:(0,g.jsx)(r,{className:"w-12 h-12 text-primary"})}),(0,g.jsx)("h1",{className:"text-3xl md:text-4xl font-serif text-gray-900 mb-4",children:s("reviews.login_required_title")}),(0,g.jsx)("p",{className:"text-gray-600 max-w-md mx-auto mb-8 text-sm md:text-base",children:s("reviews.login_required_desc")}),(0,g.jsx)(n,{to:"/login",className:"btn btn-primary rounded-full px-8 py-3 font-semibold text-base",children:s("reviews.login_cta")})]})})};export{h as default};