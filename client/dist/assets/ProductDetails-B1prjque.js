import{o as e}from"./rolldown-runtime-BgAqdD8a.js";import{a as s,r as t}from"./motion-Q_hw2Ya2.js";import{_t as r,ot as a,st as l,ut as i,vt as n,w as c,x as d}from"./vendor-D_eNeWdO.js";import"./i18n-PYB7o98L.js";import{a as o,c as m,r as x}from"./index-CSH1YS6q.js";var h=e(s(),1),u=t(),p=()=>{const{id:e}=r(),{t:s,i18n:t}=l(),{formatPrice:p}=x(),[v,g]=(0,h.useState)(null),[j,f]=(0,h.useState)(!0),{addToCart:N}=o(),[w,y]=(0,h.useState)(!1),[b,_]=(0,h.useState)([]),k=e=>{const s=t.language||"en",r=(e.translations||{})[s];return{name:(null==r?void 0:r.name)||e.name,description:(null==r?void 0:r.description)||e.description}};return(0,h.useEffect)((()=>{const s=(t=n((function*(){try{const{data:s}=yield m.get(`/products/${e}`);g(s)}catch(s){}finally{f(!1)}})),function(){return t.apply(this,arguments)});var t;s();const r=m.defaults.baseURL.replace(/\/api$/,""),a=new EventSource(`${r}/api/products/events`);return a.onmessage=t=>{try{const r=JSON.parse(t.data);"product"===r.channel&&"review_created"===r.type&&r.productId===e&&(s(),y(!0),setTimeout((()=>y(!1)),3e3),r.review&&r.review._id&&(_((e=>[...e,r.review._id])),setTimeout((()=>{_((e=>e.filter((e=>e!==r.review._id))))}),5e3)))}catch(r){}},a.onerror=e=>{},()=>{a.close()}}),[e]),j?(0,u.jsx)("div",{className:"text-center py-20 text-primary",children:s("product.loading")}):v?(0,u.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,u.jsxs)(i,{to:"/",className:"inline-flex items-center text-gray-500 hover:text-primary mb-8 transition-colors",children:[(0,u.jsx)(a,{className:"w-4 h-4 mr-2 rtl:ml-2 rtl:mr-0"}),s("back_to_shop")]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:[(0,u.jsx)("div",{className:"card p-4 ring-1 ring-transparent hover:ring-primary/20 transition-all",children:(0,u.jsxs)("div",{className:"h-[28rem] w-full overflow-hidden rounded-xl bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center relative shadow-inner",children:[(0,u.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/5 to-transparent"}),(0,u.jsx)("img",{src:(e=>{if(!e)return"";const s=e.toLowerCase();return s.startsWith("http")||s.startsWith("data:")||s.startsWith("/")?e:`/images/${e}`})(v.image),alt:v.name,className:"max-h-full max-w-full object-contain transition-all duration-700 ease-out hover:scale-105 hover:rotate-1"}),(0,u.jsx)("span",{className:"absolute top-3 left-3 bg-rose-50/80 text-gray-900 text-xs px-3 py-1 rounded-full border border-rose-200/70 backdrop-blur-md",children:v.category})]})}),(0,u.jsxs)("div",{className:"flex flex-col justify-center",children:[(0,u.jsxs)("div",{className:"mb-6",children:[(0,u.jsx)("span",{className:"text-sm text-primary font-medium tracking-wider uppercase",children:v.category}),(0,u.jsx)("h1",{className:"text-3xl md:text-4xl font-serif text-gray-900 mt-2 mb-2",children:k(v).name}),(0,u.jsx)("div",{className:"h-0.5 w-24 bg-primary/30 rounded mb-4"}),(0,u.jsxs)("div",{className:"flex items-center mb-4",children:[(0,u.jsx)("div",{className:"flex text-yellow-400",children:[...Array(5)].map(((e,s)=>(0,u.jsx)(d,{className:"w-5 h-5 "+(s<Math.floor(v.rating)?"fill-current":"text-gray-300")},s)))}),(0,u.jsx)("span",{className:"text-gray-500 ml-2 rtl:mr-2 text-sm",children:s("product.reviews_label",{count:v.numReviews})})]}),(0,u.jsx)("p",{className:"text-2xl font-bold text-primary",children:(0,u.jsx)("span",{className:"tabular-nums",children:p(v.price)})})]}),(0,u.jsx)("div",{className:"text-gray-700 leading-relaxed mb-8",children:k(v).description}),(0,u.jsxs)("div",{className:"flex items-center space-x-4 rtl:space-x-reverse",children:[(0,u.jsxs)("button",{onClick:()=>N(v),className:"btn btn-primary flex-1 py-4 shadow-lg hover:shadow-xl",disabled:0===v.countInStock,children:[(0,u.jsx)(c,{className:"w-5 h-5 mr-2 rtl:ml-2 rtl:mr-0"}),v.countInStock>0?s("add_to_cart"):s("out_of_stock")]}),(0,u.jsx)("button",{type:"button",className:"btn btn-outline w-12 h-12 p-0 rounded-full text-gray-500 hover:text-red-600 hover:border-red-200",children:(0,u.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]}),(0,u.jsx)("div",{className:"mt-8 border-t border-gray-100 pt-8",children:(0,u.jsxs)("div",{className:"flex items-center space-x-8 rtl:space-x-reverse text-sm text-gray-500",children:[(0,u.jsxs)("div",{className:"flex items-center",children:[(0,u.jsx)("span",{className:"w-2 h-2 rounded-full mr-2 rtl:ml-2 rtl:mr-0 "+(v.countInStock>0?"bg-green-500":"bg-red-500")}),v.countInStock>0?s("in_stock"):s("out_of_stock")]}),(0,u.jsx)("div",{children:s("fast_delivery")})]})})]})]}),v.reviews&&v.reviews.length>0&&(0,u.jsx)("div",{className:"mt-16",children:(0,u.jsxs)("div",{className:"border-t border-gray-200 pt-12",children:[w&&(0,u.jsxs)("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-4 flex items-center",children:[(0,u.jsx)("div",{className:"flex-shrink-0",children:(0,u.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,u.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,u.jsxs)("div",{className:"ml-3",children:[(0,u.jsx)("p",{className:"text-sm font-medium text-green-800",children:"New review added!"}),(0,u.jsx)("p",{className:"text-sm text-green-700",children:"A new review has been posted for this product."})]})]}),(0,u.jsx)("h2",{className:"text-2xl font-serif text-gray-900 mb-8",children:"Customer Reviews"}),(0,u.jsx)("div",{className:"bg-gray-50 rounded-xl p-6 mb-8",children:(0,u.jsxs)("div",{className:"flex items-center gap-4",children:[(0,u.jsx)("div",{className:"flex text-yellow-400",children:[...Array(5)].map(((e,s)=>(0,u.jsx)("svg",{className:"w-6 h-6 "+(s<Math.floor(v.rating)?"fill-current":"text-gray-300"),viewBox:"0 0 20 20",children:(0,u.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},s)))}),(0,u.jsxs)("div",{children:[(0,u.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:v.rating.toFixed(1)}),(0,u.jsxs)("p",{className:"text-sm text-gray-600",children:["Based on ",v.numReviews," ",1===v.numReviews?"review":"reviews"]})]})]})}),(0,u.jsx)("div",{className:"space-y-6",children:v.reviews.map(((e,s)=>(0,u.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-6 transition-all duration-300 "+(b.includes(e._id)?"new-review-highlight":""),children:[(0,u.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("h4",{className:"font-semibold text-gray-900",children:e.name}),(0,u.jsx)("p",{className:"text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),(0,u.jsx)("div",{className:"flex text-yellow-400",children:[...Array(5)].map(((s,t)=>(0,u.jsx)("svg",{className:"w-4 h-4 "+(t<e.rating?"fill-current":"text-gray-300"),viewBox:"0 0 20 20",children:(0,u.jsx)("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},t)))})]}),(0,u.jsx)("p",{className:"text-gray-700 leading-relaxed",children:e.comment})]},s)))})]})}),(!v.reviews||0===v.reviews.length)&&(0,u.jsx)("div",{className:"mt-16",children:(0,u.jsxs)("div",{className:"border-t border-gray-200 pt-12",children:[(0,u.jsx)("h2",{className:"text-2xl font-serif text-gray-900 mb-4",children:"Customer Reviews"}),(0,u.jsx)("div",{className:"bg-gray-50 rounded-xl p-8 text-center",children:(0,u.jsx)("p",{className:"text-gray-600",children:"No reviews yet. Be the first to review this product!"})})]})})]}):(0,u.jsx)("div",{className:"text-center py-20",children:s("product.not_found")})};export{p as default};