import{o as e}from"./rolldown-runtime-BgAqdD8a.js";import{a as s,r as a}from"./motion-Q_hw2Ya2.js";import{Q as r,Y as t,Z as i,gt as l,rt as n,st as o,u as d,ut as c,vt as m}from"./vendor-D_eNeWdO.js";import"./i18n-PYB7o98L.js";import{c as p}from"./index-CSH1YS6q.js";import{t as x}from"./useAuth-CQSRYPa0.js";var h=e(s(),1),u=a(),g=()=>{const{t:e}=o(),s=l(),{user:a,updateUser:g}=x(),[f,j]=(0,h.useState)((()=>(null==a?void 0:a.name)||"")),[v,N]=(0,h.useState)((()=>(null==a?void 0:a.email)||"")),[y,b]=(0,h.useState)(""),[w,_]=(0,h.useState)(""),[S,F]=(0,h.useState)([]),[z,D]=(0,h.useState)(!0),[k,A]=(0,h.useState)(null);(0,h.useEffect)((()=>{var e;a?(e=m((function*(){try{D(!0);const e={headers:{Authorization:`Bearer ${a.token}`}},{data:s}=yield p.get("/orders/myorders",e);F(s),D(!1)}catch(e){A(e.response&&e.response.data.message?e.response.data.message:e.message),D(!1)}})),function(){return e.apply(this,arguments)})():s("/login")}),[a,s]);const C=($=m((function*(s){if(s.preventDefault(),y===w)try{const s={headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.token}`}},{data:r}=yield p.put("/users/profile",{name:f,email:v,password:y},s);g(r),d.success(e("profile.update_success")),b(""),_("")}catch(r){const e=r.response&&r.response.data.message?r.response.data.message:r.message;d.error(e)}else d.error(e("profile.passwords_mismatch"))})),function(e){return $.apply(this,arguments)});var $;return(0,u.jsx)("div",{className:"container mx-auto px-4 py-12",children:(0,u.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-10",children:[(0,u.jsxs)("div",{className:"lg:col-span-1",children:[(0,u.jsx)("h2",{className:"text-3xl font-serif text-gray-900 mb-6",children:e("profile.title")}),(0,u.jsxs)("form",{onSubmit:C,className:"card-strong p-8 space-y-6 ring-1 ring-transparent hover:ring-primary/20 transition-all",children:[(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:e("profile.name")}),(0,u.jsx)("input",{type:"text",id:"name",placeholder:e("profile.name_placeholder"),className:"input",value:f,onChange:e=>j(e.target.value)})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:e("profile.email")}),(0,u.jsx)("input",{type:"email",id:"email",placeholder:e("profile.email_placeholder"),className:"input",value:v,onChange:e=>N(e.target.value)})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:e("profile.password")}),(0,u.jsx)("input",{type:"password",id:"password",placeholder:e("profile.enter_password_placeholder"),className:"input",value:y,onChange:e=>b(e.target.value)})]}),(0,u.jsxs)("div",{children:[(0,u.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:e("profile.confirm_password")}),(0,u.jsx)("input",{type:"password",id:"confirmPassword",placeholder:e("profile.confirm_password_placeholder"),className:"input",value:w,onChange:e=>_(e.target.value)})]}),(0,u.jsx)("button",{type:"submit",className:"btn btn-primary w-full",children:e("profile.update_btn")})]})]}),(0,u.jsxs)("div",{className:"lg:col-span-2",children:[(0,u.jsx)("h2",{className:"text-3xl font-serif text-gray-900 mb-6",children:e("profile.my_orders")}),z?(0,u.jsx)("div",{className:"text-center text-lg text-gray-600",children:e("profile.loading_orders")}):k?(0,u.jsx)("div",{className:"card p-3 text-red-700 ring-1 ring-red-200 bg-red-50/60",children:k}):(0,u.jsx)("div",{className:"card-strong p-8 ring-1 ring-transparent hover:ring-primary/20 transition-all",children:0===S.length?(0,u.jsx)("div",{className:"text-center text-lg text-gray-600",children:e("profile.no_orders")}):(0,u.jsx)("div",{className:"space-y-6",children:S.map((s=>(0,u.jsxs)("div",{className:"card p-6 hover:shadow-md transition-shadow duration-200",children:[(0,u.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,u.jsxs)("h3",{className:"text-xl font-semibold text-gray-800",children:[e("profile.order")," ",s._id]}),(0,u.jsx)(c,{to:`/order/${s._id}`,className:"text-primary hover:underline",children:e("profile.view_details")})]}),(0,u.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-gray-700 text-sm",children:[(0,u.jsxs)("p",{className:"flex items-center",children:[(0,u.jsx)(n,{className:"mr-2",size:16})," ",e("profile.date"),": ",new Date(s.createdAt).toLocaleDateString()]}),(0,u.jsxs)("p",{className:"flex items-center",children:[(0,u.jsx)(t,{className:"mr-2",size:16})," ",e("profile.total"),": $",s.totalPrice.toFixed(2)]}),(0,u.jsx)("p",{className:"flex items-center",children:s.isPaid?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(r,{className:"mr-2 text-green-500",size:16})," ",e("profile.paid_on",{date:new Date(s.paidAt).toLocaleDateString()})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i,{className:"mr-2 text-red-500",size:16})," ",e("profile.not_paid")]})}),(0,u.jsx)("p",{className:"flex items-center",children:s.isDelivered?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(r,{className:"mr-2 text-green-500",size:16})," ",e("profile.delivered_on",{date:new Date(s.deliveredAt).toLocaleDateString()})]}):(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i,{className:"mr-2 text-red-500",size:16})," ",e("profile.not_delivered")]})})]}),(0,u.jsxs)("div",{className:"mt-4",children:[(0,u.jsxs)("h4",{className:"text-md font-medium text-gray-800 mb-2",children:[e("profile.items"),":"]}),(0,u.jsx)("ul",{className:"list-disc list-inside text-gray-600",children:s.orderItems.map((s=>(0,u.jsxs)("li",{children:[s.qty," x ",s.name," ($",s.price.toFixed(2)," ",e("profile.each"),")"]},s.product)))})]})]},s._id)))})})]})]})})};export{g as default};